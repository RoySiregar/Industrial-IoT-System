<!DOCTYPE html>
<html>
<head>
    <title>Live Data Chart - Produksi Harian</title>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/data.js"></script>
</head>
<body>
    <input id="fetchURL" type="text" value="https://demo-live-data.highcharts.com/time-data.csv" />
    <input id="enablePolling" type="checkbox" checked /> Enable Polling
    <input id="pollingTime" type="number" value="2" min="1" /> Polling Time (seconds)
    <div id="container" style="width: 100%; height: 400px;"></div>

    <script>
        const defaultData = 'https://demo-live-data.highcharts.com/time-data.csv'; // Ganti dengan URL CSV yang sesuai
        const urlInput = document.getElementById('fetchURL');
        const pollingCheckbox = document.getElementById('enablePolling');
        const pollingInput = document.getElementById('pollingTime');

        function createChart() {
            Highcharts.chart('container', {
                chart: {
                    type: 'areaspline'
                },
                lang: {
                    locale: 'en-GB'
                },
                title: {
                    text: 'Jumlah Produksi Stasiun (Senin - Minggu)'
                },
                accessibility: {
                    announceNewData: {
                        enabled: true,
                        minAnnounceInterval: 15000,
                        announcementFormatter: function (allSeries, newSeries, newPoint) {
                            if (newPoint) {
                                return 'New point added. Value: ' + newPoint.y;
                            }
                            return false;
                        }
                    }
                },
                plotOptions: {
                    areaspline: {
                        color: '#32CD32',
                        fillColor: {
                            linearGradient: { x1: 0, x2: 0, y1: 0, y2: 1 },
                            stops: [
                                [0, '#32CD32'],
                                [1, '#32CD3200']
                            ]
                        },
                        threshold: null,
                        marker: {
                            lineWidth: 1,
                            lineColor: null,
                            fillColor: 'white'
                        }
                    }
                },
                xAxis: {
                    categories: ['Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu', 'Minggu']
                },
                yAxis: {
                    title: {
                        text: 'Jumlah Produksi'
                    }
                },
                data: {
                    csvURL: urlInput.value,
                    enablePolling: pollingCheckbox.checked === true,
                    dataRefreshRate: parseInt(pollingInput.value, 10) * 1000 // Mengubah detik menjadi milidetik
                }
            });
            if (pollingInput.value < 1 || !pollingInput.value) {
                pollingInput.value = 1;
            }
        }

        urlInput.value = defaultData;

        // We recreate instead of using chart update to make sure the loaded CSV
        // and such is completely gone.
        pollingCheckbox.onchange = urlInput.onchange = pollingInput.onchange = createChart;

        // Create the chart
        createChart();
    </script>
</body>
</html>
